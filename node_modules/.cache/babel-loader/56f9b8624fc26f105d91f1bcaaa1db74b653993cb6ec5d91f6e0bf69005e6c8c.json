{"ast":null,"code":"var _jsxFileName = \"/Users/yaothao/Documents/Yellow Page Research/public-facing/prototype/src/SearchBar.js\";\nimport React from \"react\";\nimport { useStateValue } from './StateProvider';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass Helpers {\n  static contains(orig, filter) {\n    let res = filter.map(item => {\n      return orig.includes(item);\n    });\n    return !res.includes(false);\n  }\n  static hasDuplicates(array) {\n    return new Set(array).size !== array.length;\n  }\n}\nclass SearchBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      inputValue: '',\n      tagList: useStateValue()\n    };\n    this.handleNewTag = this.handleNewTag.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleTagDelete = this.handleTagDelete.bind(this);\n    this.deleteTag = this.deleteTag.bind(this);\n    this.notDuplicate = this.notDuplicate.bind(this);\n    this.updateControlledTags = this.updateControlledTags.bind(this);\n  }\n  handleNewTag(tags) {\n    if (this.props.onNewTag) this.props.onNewTag(tags);\n    if (this.props.onTagChange) this.props.onTagChange(tags);\n  }\n  handleInputChange(_ref) {\n    let {\n      target: {\n        value: inputValue\n      }\n    } = _ref;\n    inputValue = inputValue === ',' ? '' : inputValue;\n    this.setState({\n      inputValue\n    });\n  }\n  handleKeyDown(e) {\n    let {\n      key,\n      target: {\n        value\n      }\n    } = e;\n    let {\n      tags\n    } = this.state;\n    switch (key) {\n      case 'Tab':\n        if (value) e.preventDefault();\n      case 'Enter':\n      case ',':\n        value = value.trim();\n        if (value && this.notDuplicate(tags, value)) {\n          this.addTag(value);\n        } else {\n          this.setState({\n            inputValue: ''\n          });\n        }\n        break;\n      case 'Backspace':\n        if (!value) {\n          this.handleTagDelete(tags.length - 1);\n        }\n        break;\n    }\n  }\n  handleTagDelete(index, e) {\n    this.deleteTag(index, () => {\n      this.props.onTagChange(this.state.tags);\n    });\n  }\n  deleteTag(index, callback) {\n    let tags = this.state.tags.slice();\n    tags.splice(index, 1);\n    this.setState({\n      tags\n    }, () => {\n      if (callback) callback();\n    });\n  }\n  notDuplicate(tags, newTag) {\n    return !tags.includes(newTag) || this.props.allowDuplicates;\n  }\n  addTag(tag) {\n    if (this.notDuplicate(this.state.tags, tag)) {\n      this.setState({\n        tags: [...this.state.tags, tag],\n        inputValue: ''\n      }, () => {\n        this.handleNewTag(this.state.tags);\n      });\n    }\n  }\n  updateControlledTags(tags) {\n    if (tags && !Helpers.hasDuplicates(tags)) {\n      this.setState({\n        tags\n      }, () => {\n        // this.props.onTagChange(tags);\n      });\n    }\n  }\n  componentWillReceiveProps(nextProps) {\n    this.updateControlledTags(nextProps.tags);\n  }\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"tagInputWrapper\",\n      children: [/*#__PURE__*/_jsxDEV(TagsList, {\n        tags: this.state.tags,\n        onTagDelete: this.handleTagDelete,\n        hashtag: this.props.hashtag\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"tagInput\",\n        className: \"tagInput\",\n        placeholder: \"enter a tag...\",\n        value: this.state.inputValue,\n        onChange: this.handleInputChange,\n        onKeyDown: this.handleKeyDown\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }, this);\n  }\n}\nconst TagsList = _ref2 => {\n  let {\n    tags,\n    onTagDelete,\n    hashtag\n  } = _ref2;\n  let list = tags.map((tag, index) => /*#__PURE__*/_jsxDEV(DeletableTag, {\n    name: tag,\n    onDelete: onTagDelete,\n    index: index,\n    hashtag: hashtag\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 7\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"ul\", {\n    name: \"tagsList\",\n    className: \"tagsList\",\n    children: list\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 7\n  }, this);\n};\n_c = TagsList;\nconst DeletableTag = _ref3 => {\n  let {\n    name,\n    index,\n    onDelete,\n    hashtag\n  } = _ref3;\n  return /*#__PURE__*/_jsxDEV(\"li\", {\n    children: [hashtag && /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        color: 'rgb(87, 7, 7)',\n        fontWeight: 'bold'\n      },\n      children: \"# \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }, this), name, /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"#\",\n      onClick: e => onDelete(index, e),\n      children: \"x\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 145,\n    columnNumber: 7\n  }, this);\n};\n_c2 = DeletableTag;\nexport default SearchBar;\nvar _c, _c2;\n$RefreshReg$(_c, \"TagsList\");\n$RefreshReg$(_c2, \"DeletableTag\");","map":{"version":3,"names":["React","useStateValue","Helpers","contains","orig","filter","res","map","item","includes","hasDuplicates","array","Set","size","length","SearchBar","Component","constructor","props","state","inputValue","tagList","handleNewTag","bind","handleInputChange","handleKeyDown","handleTagDelete","deleteTag","notDuplicate","updateControlledTags","tags","onNewTag","onTagChange","target","value","setState","e","key","preventDefault","trim","addTag","index","callback","slice","splice","newTag","allowDuplicates","tag","componentWillReceiveProps","nextProps","render","hashtag","TagsList","onTagDelete","list","DeletableTag","name","onDelete","color","fontWeight"],"sources":["/Users/yaothao/Documents/Yellow Page Research/public-facing/prototype/src/SearchBar.js"],"sourcesContent":["import React from \"react\";\nimport { useStateValue } from './StateProvider';\n\nclass Helpers {\n    static contains(orig, filter) {\n      let res = filter.map(item => {\n        return orig.includes(item);\n      });\n      return !res.includes(false);\n    }\n    \n    static hasDuplicates(array) {\n      return (new Set(array)).size !== array.length;\n    }\n}\n\nclass SearchBar extends React.Component {\n    constructor(props) {\n      super(props);\n    \n      this.state = {\n        inputValue: '',\n        tagList: useStateValue()\n      }\n      \n      this.handleNewTag = this.handleNewTag.bind(this);\n      this.handleInputChange = this.handleInputChange.bind(this);\n      this.handleKeyDown = this.handleKeyDown.bind(this);\n      this.handleTagDelete = this.handleTagDelete.bind(this);\n      this.deleteTag = this.deleteTag.bind(this);\n      this.notDuplicate = this.notDuplicate.bind(this);\n      this.updateControlledTags = this.updateControlledTags.bind(this);\n    }\n    \n    handleNewTag(tags) {\n      if (this.props.onNewTag) this.props.onNewTag(tags);\n      if (this.props.onTagChange) this.props.onTagChange(tags);\n    }\n  \n    handleInputChange({target: { value: inputValue }}) {\n      inputValue = inputValue === ',' ? '' : inputValue;\n      this.setState({inputValue});\n    }\n    \n    handleKeyDown(e) {\n      let { key, target: {value} } = e;\n      let { tags } = this.state;\n      switch (key) {\n        case 'Tab':\n          if (value) e.preventDefault();\n        case 'Enter':\n        case ',':\n          value = value.trim();\n          if (value && this.notDuplicate(tags, value)) {\n            this.addTag(value);\n          } else {\n            this.setState({inputValue: ''})\n          }\n          break;\n        case 'Backspace':\n          if (!value) {\n            this.handleTagDelete(tags.length - 1);\n          }\n          break;\n      }\n    }\n    \n    handleTagDelete(index, e) {\n      this.deleteTag(index, () => {\n        this.props.onTagChange(this.state.tags);\n      });\n    }\n    \n    deleteTag(index, callback) {\n      let tags = this.state.tags.slice();\n      \n      tags.splice(index, 1);\n      this.setState({ tags }, () => {\n        if (callback) callback();\n      });\n    }\n    \n    notDuplicate(tags, newTag) {\n      return (!tags.includes(newTag) || this.props.allowDuplicates);\n    }\n    \n    addTag(tag) {\n      if (this.notDuplicate(this.state.tags, tag)) {\n        this.setState({tags: [...this.state.tags, tag], inputValue: ''}, () => {\n          this.handleNewTag(this.state.tags);\n        });\n      }\n    }\n    \n    updateControlledTags(tags) {\n      if (tags && !Helpers.hasDuplicates(tags)) {\n        this.setState({ tags }, () => {\n          // this.props.onTagChange(tags);\n        });\n      }\n    }\n    \n    componentWillReceiveProps(nextProps) {\n      this.updateControlledTags(nextProps.tags);\n    }\n    \n    render() {\n      return (\n        <span className=\"tagInputWrapper\">\n          <TagsList \n            tags={this.state.tags} \n            onTagDelete={this.handleTagDelete} \n            hashtag={this.props.hashtag}\n          />\n          <input \n            name=\"tagInput\" \n            className=\"tagInput\" \n            placeholder=\"enter a tag...\" \n            value={this.state.inputValue} \n            onChange={this.handleInputChange}\n            onKeyDown={this.handleKeyDown}\n          />\n        </span>\n      );\n    }\n}\n\nconst TagsList = ({tags, onTagDelete, hashtag}) => {\n    let list = tags.map((tag, index) => (\n      <DeletableTag \n        name={tag} \n        onDelete={onTagDelete} \n        index={index} \n        hashtag={hashtag} />\n    ));\n    return (\n      <ul name=\"tagsList\" className=\"tagsList\">\n        {list}\n      </ul>\n    )\n  }\n  \n  const DeletableTag = ({name, index, onDelete, hashtag}) => {\n    return (\n      <li>\n        {hashtag && (\n          <span style={{color: 'rgb(87, 7, 7)', fontWeight: 'bold'}}># </span>\n        )}\n        {name} \n        <a href=\"#\" onClick={e => onDelete(index, e)}>x</a>\n      </li>\n    );\n  }\n\nexport default SearchBar;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}